<html>
<head>
<script src="/web_shell/scripts/esprima/esprima.js"></script>
<script>
var code = 'var answer = 42; something qwer = fasf; var a = 2;';
code = 'var answer = 42\nsomething qwer = fasf; var a = 2;';
// code = 'var answer = 42; var qwer = fasf\nvar a = 2;';

var syntax;
try {
  syntax = esprima.parse(code, {
    loc: true,
    range: true,
    tolerant: true,
    comment: true,
    raw: true,
    tokens: true
  });
} catch(e) {
  if (e.description == "Unexpected identifier") {
    var start = e.index;
    start = code.lastIndexOf(" ", start - 2) + 1;
    var end = code.indexOf(" ", start);
    var identifier = code.substr(start, length);
    code = code.substr(0, start) + "var" + code.substr(end);
    console.log(code);
  }
}

  syntax = esprima.parse(code, {
    loc: true,
    range: true,
    tolerant: true,
    comment: true,
    raw: true,
    tokens: true
  });

console.log(syntax);
</script>
</head>
<body>

</body>
</html>

<!-- Since Esprima supports AMD (Asynchronous Module Definition), it can be loaded via a module loader such as RequireJS:

require(['esprima'], function (parser) {
    // Do something with parser, e.g.
    var syntax = parser.parse('var answer = 42');
    console.log(JSON.stringify(syntax, null, 4));
}); -->